generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model carrinho {
  user_id    Int
  produto_id Int
  quantidade Int
  produto    produto @relation(fields: [produto_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_has_produto_produto1")
  user       user    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_has_produto_user1")

  @@id([user_id, produto_id])
  @@index([produto_id], map: "fk_user_has_produto_produto1_idx")
  @@index([user_id], map: "fk_user_has_produto_user1_idx")
}

model comentario {
  id         Int      @unique(map: "id_UNIQUE") @default(autoincrement())
  texto      String?  @db.VarChar(90)
  user_id    Int
  produto_id Int
  produto    produto  @relation(fields: [produto_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_comentario_produto1")
  user       user     @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_comentario_user1")
  imagem     imagem[]

  @@id([id, user_id, produto_id])
  @@index([produto_id], map: "fk_comentario_produto1_idx")
  @@index([user_id], map: "fk_comentario_user1_idx")
}

model endereco {
  id          Int     @unique(map: "id_UNIQUE")
  nome        String? @db.VarChar(45)
  estado      String? @db.VarChar(45)
  cidade      String? @db.VarChar(45)
  bairro      String? @db.VarChar(45)
  rua         String? @db.VarChar(45)
  numero      String? @db.VarChar(45)
  complemento String? @db.VarChar(45)
  user_id     Int
  user        user    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_endereco_user1")

  @@id([id, user_id])
  @@index([user_id], map: "fk_endereco_user1_idx")
}

model favorito {
  user_id    Int
  produto_id Int
  produto    produto @relation(fields: [produto_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_has_produto_produto3")
  user       user    @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_user_has_produto_user3")

  @@id([user_id, produto_id])
  @@index([produto_id], map: "fk_user_has_produto_produto3_idx")
  @@index([user_id], map: "fk_user_has_produto_user3_idx")
}

model imagem {
  id                    Int        @id @unique(map: "id_UNIQUE") @default(autoincrement())
  caminho_arquivo       String     @db.VarChar(255)
  produto_id            Int
  comentario_id         Int
  comentario_user_id    Int
  comentario_produto_id Int
  user_id               Int
  comentario            comentario @relation(fields: [comentario_id, comentario_user_id, comentario_produto_id], references: [id, user_id, produto_id], onDelete: NoAction, onUpdate: NoAction, map: "fk_imagem_comentario1")
  produto               produto    @relation(fields: [produto_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_imagem_produto1")
  user                  user       @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_imagem_user1")

  @@index([comentario_id, comentario_user_id, comentario_produto_id], map: "fk_imagem_comentario1_idx")
  @@index([produto_id], map: "fk_imagem_produto1_idx")
  @@index([user_id], map: "fk_imagem_user1_idx")
}

model produto {
  id            Int          @id @unique(map: "id_UNIQUE") @default(autoincrement())
  nome          String       @db.VarChar(45)
  descricao     String       @db.LongText
  categoria     String       @db.VarChar(45)
  valor         Int
  valordesconto Int?
  avalicao      Int?
  carrinho      carrinho[]
  comentario    comentario[]
  favorito      favorito[]
  imagem        imagem[]
}

model user {
  id         Int          @id @unique(map: "id_UNIQUE") @default(autoincrement())
  nome       String       @db.VarChar(45)
  email      String       @unique(map: "email_UNIQUE") @db.VarChar(60)
  senha      String       @db.VarChar(15)
  telefone   Int?         @unique(map: "telefone_UNIQUE")
  foto       String?      @db.VarChar(45)
  cpf        String?      @db.VarChar(12)
  carrinho   carrinho[]
  comentario comentario[]
  endereco   endereco[]
  favorito   favorito[]
  imagem     imagem[]
}
